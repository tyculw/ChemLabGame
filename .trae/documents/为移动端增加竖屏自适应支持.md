## 目标
- 在现有 PC 横屏布局不变的前提下，新增对手机（iOS/Android/鸿蒙）浏览器的识别与竖屏自适应布局。
- 优化移动端交互：更大的点击区域、底部抽屉式日志面板、拖拽支持触控事件、内容在竖屏合理排布。

## 设备与方向识别
- 新增 `useDeviceInfo` Hook（`src/hooks/useDeviceInfo.ts`）：
  - `isMobilePhone`：基于 `navigator.userAgent`（iPhone/Android/HarmonyOS）+ `matchMedia('(pointer: coarse)')` + 视窗宽高阈值综合判断。
  - `isPortrait`：`matchMedia('(orientation: portrait)')` 实时监听。
  - `isTouch`：`('ontouchstart' in window)` 或 `navigator.maxTouchPoints > 0`。
- 在 `App.tsx` 读取上述信息，驱动布局选择：PC 保持横屏，手机以竖屏布局为主；当手机处于横屏时，显示“请旋转至竖屏”的轻提示覆盖层（不强制锁屏）。

## 根布局调整（App）
- 代码位置：`src/App.tsx:160-198` 当前根容器为 `flex` 左主区 + 右固定日志。
- 调整策略：
  - PC：沿用现状 `flex-row` + 右侧 `LogPanel`。
  - 手机竖屏：改为 `flex-col`，主内容在上，日志面板改为底部抽屉；全局 `overflow-y-auto`，避免高度溢出。
- 同时将 `LogPanel` 的摆放与形态交给新属性控制（见下）。

## 日志面板重构（底部抽屉化）
- 代码位置：`src/components/LogPanel.tsx:12-24`、`26-41`、`90-92`。
- 变更点：
  - 新增 `placement` 属性：`'right' | 'bottom'`，默认 `'right'`（PC）。
  - 当 `placement='bottom'` 时：
    - 使用 `fixed bottom-0 left-0 right-0`，宽度 `w-full`；折叠高度 `h-12`，展开高度例如 `h-72`。
    - 切换按钮改为位于抽屉顶部中央；原有纵向“Logs”指示改为水平指示。
    - 适配安全区域：在内容容器中增加 `padding-bottom: env(safe-area-inset-bottom)`（见 CSS 工具）。
- 在 `App.tsx` 调用时，根据 `isMobilePhone && isPortrait` 传入 `placement='bottom'`，并默认初始为折叠态。

## 页面竖屏布局优化
- 材料选择页：`src/components/MaterialSelectionPage.tsx`
  - 位置与现状：`37` 行根容器 `flex h-full`，左右双栏：左 `w-1/3`，右 `w-2/3`。
  - 调整：改为 `flex-col md:flex-row`；左栏 `w-full md:w-1/3`，右栏 `w-full md:w-2/3`。
  - 网格：`grid-cols-2` 在小屏保持两列，但当极窄屏时以 `grid-cols-1`；槽位卡尺寸从 `w-48 h-64` 在小屏降为 `w-32 h-48`，保证可视同时避免溢出。
  - 顶部返回按钮与主标题在手机上使用更紧凑的间距与字号（Tailwind 断点）。
- 操作选择页：`src/components/OperationSelectionPage.tsx`
  - 位置：`35-56` 操作卡片栅格；保持 `grid-cols-1 md:grid-cols-2`。
  - 调整：增加按钮外边距与点击区域；在小屏上卡片内文 `text-sm`，图标尺寸保持可点性（如 32px）。
- 结果页：`src/components/ResultPage.tsx:88-177`
  - 调整：保持现有 `flex-wrap`；在小屏将生成物卡 `w-24 h-24`维持，周边文字缩至 `text-sm`；确保整体容器 `overflow-y-auto`。
- 引导页：`src/components/IntroPage.tsx:18-41` 已用 `grid-cols-1 md:grid-cols-3`，仅微调卡片内边距与按钮间距以适配小屏。

## 触控拖拽支持（实验台）
- 代码位置：`src/components/LabBench.tsx`（当前仅鼠标事件）
- 新增：
  - `onTouchStart`、`onTouchMove`、`onTouchEnd` 与现有拖拽状态机复用；坐标计算基于 `touches[0].clientX/clientY` 与基准 `benchRef.getBoundingClientRect()`。
  - 在手机端将物品命中半径与按钮面积稍增（例如将 `w-16 h-16` 在手机下变为 `w-20 h-20`），便于触控精度。
  - 在空状态的引导文案增加更明确的触控提示（如 “轻触并拖动将物质移入此区域”）。

## CSS 与安全区
- `index.html:7` 更新 viewport：`content="width=device-width, initial-scale=1, viewport-fit=cover"`。
- 在 `src/index.css` 增加实用工具类：
  - `.safe-area-bottom { padding-bottom: env(safe-area-inset-bottom); }`
  - `.safe-area-top { padding-top: env(safe-area-inset-top); }`
- 如需基于方向的类，可加：
  - `@media (orientation: portrait) { .portrait\:flex-col { flex-direction: column; } }`
  - 也可通过 React 条件渲染传 Tailwind 类，保持一致性。

## 行为逻辑与非强制锁屏
- 网页无法强制锁竖屏（除非全屏 API 且用户同意），因此在手机横屏时显示提示遮罩层（半透明、可关闭），建议用户旋转至竖屏以获得最佳体验。

## 验证与测试
- 本地在 Chrome DevTools 设备模拟器下测试 iPhone、Android、HarmonyOS 机型：
  - 竖屏布局是否生效；横屏提示是否出现且可关闭。
  - 日志面板是否作为底部抽屉工作（展开/收起、滚动区域不溢出）。
  - 材料选择页是否可滚动且槽位/网格适配不同宽度。
  - 实验台触控拖拽是否顺畅，位置计算是否正确。
- 回归 PC：确认横屏布局与右侧日志面板行为不变。

## 变更范围（文件）
- `src/App.tsx`（根布局与日志面板摆放、横屏提示覆盖层）
- `src/components/LogPanel.tsx`（抽屉方位与展开样式支持）
- `src/components/MaterialSelectionPage.tsx`（竖屏栈式布局与尺寸调整）
- `src/components/LabBench.tsx`（触控事件与尺寸调整）
- `src/components/OperationSelectionPage.tsx`（按钮区域密度与移动端字号）
- `src/components/IntroPage.tsx`（移动端间距微调）
- `src/index.css`（安全区与可选方向工具类）
- `index.html`（viewport-fit 支持）
- 可选新增：`src/hooks/useDeviceInfo.ts`

## 交付结果
- 手机端访问自动启用竖屏优化布局与交互；PC 保持原横屏体验。
- 代码采用 Tailwind 断点与轻量设备检测，保证最小改动与可维护性。